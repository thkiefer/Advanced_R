<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Line profiling.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for lineprof {lineprof}"><tr><td>lineprof {lineprof}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Line profiling.</h2>

<h3>Description</h3>

<p><code>lineprof</code> uses R built-in time and memory profiler <code><a href="../../utils/html/Rprof.html">Rprof</a></code>
to collect line profiling data and displays it in ways that help you
figure out where the bottlenecks in your code R.
</p>


<h3>Usage</h3>

<pre>
lineprof(code, interval = 0.001, torture = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>code</code></td>
<td>
<p>code to profile.</p>
</td></tr>
<tr valign="top"><td><code>interval</code></td>
<td>
<p>interval, in seconds, between profile snapshots. R's timer
has a resolution of at best 1 ms, so there's no reason to make this value
smaller, but if you're profiling a long running function you might want to
set it to something larger.</p>
</td></tr>
<tr valign="top"><td><code>torture</code></td>
<td>
<p>if <code>TRUE</code>, turns on <code><a href="../../base/html/gctorture.html">gctorture</a></code> which forces
<code><a href="../../base/html/gc.html">gc</a></code> to run after (almost) every allocation. This is useful
if you want to see exactly when memory is released. It also makes R run
extremely slowly (10-100x slower than usual) so it can also be useful to
simulate a smaller <code>interval</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R's profiler is a sampling profiler, which means that it stops execution
every <code>interval</code> seconds and records the current call stack. This means
that it is somewhat random: if you run the profiler repeatedly on the same
code you'll see slightly different outputs depending on exactly where the
profiler stopped each time.
</p>


<h3>Profiling output</h3>

<p>For each sequence of calls, <code>lineprof</code> calculates:
</p>

<ul>
<li> <p><code>time</code>: the time in seconds
</p>
</li>
<li> <p><code>alloc</code>: the memory allocated, in megabytes
</p>
</li>
<li> <p><code>released</code>: the memory released, in megabytes. Unless
<code>torture = TRUE</code> this release is somewhat random:
memory will be only released if a garbage collection is triggered by
an allocation.
</p>
</li>
<li> <p><code>dups</code>: the number of calls to the internal <code>duplicate</code>
function which is called by C code to duplicate R vectors.
</p>
</li></ul>

<p>Note that memory allocation is only approximate due to the nature of the
sampling profiler: if a large block of memory is allocated and then released
in between ticks of the timer, no change in memory will be recorded. Using
<code>torture = TRUE</code> helps prevent this, mostly by making R super slow.
</p>


<h3>Navigation</h3>

<p>There are two ways to navigate through the line profiling output:
using a shiny GUI, generated by <code><a href="shine.html">shine</a></code>; or through the
command line, using <code><a href="focus.html">focus</a></code>.
</p>


<h3>Display</h3>

<p>The default print method uses <code>reduce_depth</code> to reduce the call stack
to show only two steps down, and then formats the output with
<code>format.lineprof</code>. An alternative option is to use
<code><a href="align.html">align</a></code>, which when src refs are available, will align the
profiling data with the original source code.
</p>


<h3>Examples</h3>

<pre>
source(find_ex("read-delim.r"))
source(find_ex("read-table.r")) # local copy so get line numbers
wine &lt;- find_ex("wine.csv")

## Not run: 
x1 &lt;- lineprof(read.table2(wine, sep = ","), torture = TRUE)
x2 &lt;- lineprof(read_delim(wine), torture = TRUE)

shine(x1)
shine(x2)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>lineprof</em> version 0.1.9001 <a href="00Index.html">Index</a>]</div>
</body></html>
